<!DOCTYPE html>
<html>
<head>
  <title>Nearby Pokemon</title>
  <link rel="shortcut icon" type="image/png" href="favicon.png"/>
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet"> 
  <style>
  	body {
  	font-family: 'Lato', sans-serif;
	font-size: 48px;
	color: #445956;
	padding: 20px;
	}
	
	#grid {
		height: 100%;
		padding: 50px;
	}
	.cell {
		width: 33.333%;
		height: 33.333%;
		float: left;
	}
  </style>
</head>
<body>
	<center>NEARBY</center>
	<hr>
	<center><img id="loading" src="images/poke.gif" style="visibility:hidden;"/></center>
	<div id="grid">
		<div class="cell"><center><img id="i0"/><br><img id="f0"/></center></div>
		<div class="cell"><center><img id="i1"/><br><img id="f1"/></center></div>
		<div class="cell"><center><img id="i2"/><br><img id="f2"/></center></div>
		<div class="cell"><center><img id="i3"/><br><img id="f3"/></center></div>
		<div class="cell"><center><img id="i4"/><br><img id="f4"/></center></div>
		<div class="cell"><center><img id="i5"/><br><img id="f5"/></center></div>
		<div class="cell"><center><img id="i6"/><br><img id="f6"/></center></div>
		<div class="cell"><center><img id="i7"/><br><img id="f7"/></center></div>
		<div class="cell"><center><img id="i8"/><br><img id="f8"/></center></div>
	</div>
</body>
<script src="browserifiedpokego-scan.js"></script>
<script>
function scan(){
	navigator.geolocation.getCurrentPosition( function(position) {
		
		document.getElementById("loading").style.visibility = "visible";
		
		var coords = {
			latitude: position.coords.latitude,
			longitude: position.coords.longitude
		};
		
		pokegoScan(coords, function(err, pokemon) {
			if (err) throw err; 

			var nearbyPokemon = 0;
		
			for (var current = 0; current<pokemon.length; current++)
			{
				console.log(current + ": " + pokemon[current].name + " is " + pokemon[current].distance + "m away.");
			
				if (pokemon[current].distance <= 250)
				{
					if (nearbyPokemon < 9)
					{
						if (current == 0 || pokemon[current].distance != pokemon[current-1].distance || pokemon[current].name != pokemon[current-1].name)
						{
							if (pokemon[current].pokemonId < 10) num = "00" + pokemon[current].pokemonId;
							else if (pokemon[current].pokemonId < 100) num = "0" + pokemon[current].pokemonId;
							else num = pokemon[current].pokemonId;
							document.getElementById("i" + nearbyPokemon).src = "images/" + num + ".png";

							if (pokemon[current].distance < 40) {}
							else if (pokemon[current].distance <= 60) document.getElementById(id).src = "images/1foot.png";
							else if (pokemon[current].distance <= 90) document.getElementById(id).src = "images/2feet.png";
							else document.getElementById("f" + nearbyPokemon).src = "images/3feet.png";
							
							nearbyPokemon++;
						}
					} else break;
				}
				else break;
			}
			
			document.getElementById("loading").style.visibility = "hidden";
		});
		
		setTimeout('window.location.reload();', 31000);
	});
}

scan();
</script>
</html>
